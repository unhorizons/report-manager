{% apply spaceless %}
    <!DOCTYPE html>
    <html lang="{{ app.request.locale() | default('fr') }}">
    <head>
        <meta charset="utf-8">
        <meta name="author" content="devscast">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="shortcut icon" href="{{ asset('/images/logo_icon.png') }}">
        <title>{% block title %}{% endblock %} | UNH Rapports</title>

        {# PWA support #}
        <meta name="theme-color" content="#6576ff">
        <link rel="manifest" href="{{ asset('manifest.json') }}">

        {# PWA Support IOS #}
        <link rel="apple-touch-icon" sizes="128x128" href="{{ asset('images/icons/maskable_icon_x128.png') }}">
        <link rel="apple-touch-icon" sizes="192x192" href="{{ asset('images/icons/maskable_icon_x192.png') }}">
        <link rel="apple-touch-startup-image" href="{{ asset('images/icons/maskable_icon.png') }}">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        {% block meta %}{% endblock %}
        {{ encore_entry_link_tags('app') }}
        {% block stylesheets %}{% endblock %}

        <script defer data-turbo-track="reload" src="{{ asset('/static/bundle.js') }}"></script>

        {{ encore_entry_script_tags('app') }}
    </head>
    <body class="nk-body bg-lighter has-sidebar ui-shady" {{ stimulus_controller('turbo') }}>
    {% include 'shared/component/_flash.html.twig' %}
    <div class="nk-app-root">
        <div class="nk-main">
            {% block sidebar %}
                {% embed "shared/component/_sidebar.html.twig" %}{% endembed %}
            {% endblock %}
            <div class="nk-wrap">
                {% block navbar %}
                    {% include 'shared/component/_navbar.html.twig' %}
                {% endblock %}
                <div class="nk-content">
                    <div class="container-fluid">
                        <div class="nk-content-inner">
                            {% block body %}
                                <div class="nk-content-body">
                                    {% block header %}{% endblock %}
                                    <div class="nk-block">
                                        {% block content %}{% endblock %}
                                    </div>
                                </div>
                            {% endblock %}
                        </div>
                    </div>
                </div>
                {% block footer %}
                    {% embed "shared/component/_footer.html.twig" %}{% endembed %}
                {% endblock %}
            </div>
        </div>
    </div>

    <script>
        window.unh_report = {
            ...(window.unh_report || {}),
            ADMIN: {{ is_granted('ROLE_ADMIN') ? 'true' : 'false' }},
            USER: {{ app.user ? app.user.id : 'null' }},
            MERCURE_URL: "{{ mercure_subscribe_url }}",
            BASE_URL: "{{ app.request.schemeAndHttpHost }}",
            NOTIFICATION: new Date({{ (app.user and app.user.notificationsReadAt) ? app.user.notificationsReadAt.timestamp * 1000 : 0 }})
        }
    </script>
    {% block javascripts %}{% endblock %}
    </body>
    </html>
{% endapply %}
